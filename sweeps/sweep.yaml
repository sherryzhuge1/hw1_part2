program: sweep_train.py
method: bayes
metric:
  name: val_acc
  goal: maximize

# Early termination using Hyperband
early_terminate:
  type: hyperband
  min_iter: 2  # First evaluation after 2 epochs
  eta: 2       # Halve the remaining runs at each bracket
  s: 2         # Number of brackets

parameters:
  subset:
    value: 0.3
  epochs:
    value: 30

  # Primary parameters (wider search space)
  context:
    distribution: int_uniform
    min: 5
    max: 50
  dropout:
    distribution: uniform
    min: 0.0
    max: 0.5
  freq_mask_param:
    distribution: int_uniform
    min: 2
    max: 16
  time_mask_param:
    distribution: int_uniform
    min: 4
    max: 24

  # Secondary parameters (narrower search space)
  learning_rate:
    distribution: log_uniform_values
    min: 0.001   # Narrowed from 0.0001
    max: 0.005   # Narrowed from 0.01
  weight_decay:
    distribution: log_uniform_values
    min: 0.03    # Narrowed from 0.01
    max: 0.07    # Narrowed from 0.1
  r_drop_alpha:
    distribution: uniform
    min: 4.0     # Narrowed from 3.0
    max: 6.0     # Narrowed from 7.0
  grad_clip:
    distribution: uniform
    min: 0.8     # Narrowed from 0.5
    max: 1.2     # Narrowed from 2.0